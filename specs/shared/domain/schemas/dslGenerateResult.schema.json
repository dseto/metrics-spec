{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "dslGenerateResult.schema.json",
  "title": "DslGenerateResult",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "dsl",
    "outputSchema",
    "rationale",
    "warnings"
  ],
  "properties": {
    "dsl": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "profile",
        "text"
      ],
      "properties": {
        "profile": {
          "type": "string",
          "enum": [
            "jsonata",
            "jmespath",
            "custom"
          ],
          "default": "jsonata"
        },
        "text": {
          "type": "string",
          "minLength": 1,
          "maxLength": 20000
        }
      }
    },
    "outputSchema": {
      "type": "object",
      "minProperties": 1
    },
    "exampleRows": {
      "type": [
        "array",
        "null"
      ],
      "description": "Optional example output rows (JSON array)."
    },
    "rationale": {
      "type": "string",
      "minLength": 0,
      "maxLength": 8000
    },
    "warnings": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1,
        "maxLength": 2000
      },
      "maxItems": 20
    },
    "modelInfo": {
      "type": [
        "object",
        "null"
      ],
      "additionalProperties": false,
      "properties": {
        "provider": {
          "type": "string"
        },
        "model": {
          "type": "string"
        },
        "promptVersion": {
          "type": "string"
        }
      }
    }
  },
  "examples": [
    {
      "dsl": {
        "profile": "jsonata",
        "text": "$.result.{timestamp: timestamp, hostName: host, cpuUsagePercent: cpu*100}"
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "timestamp": {
            "type": "string"
          },
          "hostName": {
            "type": "string"
          },
          "cpuUsagePercent": {
            "type": "number",
            "minimum": 0,
            "maximum": 100
          }
        },
        "required": [
          "timestamp",
          "hostName",
          "cpuUsagePercent"
        ],
        "additionalProperties": true
      },
      "rationale": "Mapeia campos e converte cpu (0-1) para percent (0-100).",
      "warnings": []
    }
  ]
}
