# Unit Golden Tests Suite
# Data: 2026-01-02
# Esta suite é a referência canônica para casos mínimos de transformação + CSV.
#
# Convenções:
# - dslProfile: "jsonata" é obrigatório na v1.x
# - inputFile/expected* são relativos ao diretório deste arquivo (./fixtures)
# - A Engine deve:
#   1) aplicar DSL (jsonata) sobre o JSON de input
#   2) **normalizar** (object -> [object]) antes de validar
#   3) validar o output contra o expectedSchemaFile (JSON Schema 2020-12)
#   4) gerar CSV determinístico conforme specs (csv-format.md)

version: 1
tests:
  - name: HostsCpuTransform
    description: Transforma métricas por host e gera CSV com 3 colunas.
    dslProfile: jsonata
    dslFile: ./fixtures/hosts-cpu-dsl.jsonata
    inputFile: ./fixtures/hosts-cpu-input.json
    expectedOutputFile: ./fixtures/hosts-cpu-expected-output.json
    expectedSchemaFile: ./fixtures/hosts-cpu-output.schema.json
    expectedCsvFile: ./fixtures/hosts-cpu-expected.csv

  - name: QuotingTransform
    description: Garante quoting/escape RFC4180 (vírgula, aspas, newline).
    dslProfile: jsonata
    dslFile: ./fixtures/quoting-dsl.jsonata
    inputFile: ./fixtures/quoting-input.json
    expectedOutputFile: ./fixtures/quoting-expected-output.json
    expectedSchemaFile: ./fixtures/quoting-output.schema.json
    expectedCsvFile: ./fixtures/quoting-expected.csv
